<header>
  <!-- Header Container -->
  <div class="container">
    <!-- Left side -->
    <div class="navbar-brand">
      <img src="assets/images/logo-unibouw.svg" alt="logo" />
    </div>

    <!-- Right side -->
    <div class="header-right">
      <!-- Notification -->
      <div class="notification" *ngIf="isAdmin">
        <i class="fa fa-gear" title="Set RFQ Reminder" (click)="openReminderConfig()"></i>
      </div>

      <!-- User Dropdown -->
      <div class="user-dropdown">
        <button
          type="button"
          class="dropdown-btn"
          (click)="toggleUserDropdown($event)"
          style="border: none; background: transparent"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="22"
            width="22"
            viewBox="0 0 48 48"
            fill="#03303E"
          >
            <circle cx="24" cy="18" r="8" />
            <path d="M24 28c-8 0-14 4-14 8v4h28v-4c0-4-6-8-14-8z" />
            <circle cx="24" cy="24" r="22" fill="none" stroke="#03303E" stroke-width="3" />
          </svg>

          {{ getUserName() }}
          <i class="fa-solid fa-caret-down"></i>
        </button>

        <div class="dropdown-menu1" *ngIf="userDropdownOpen" (click)="$event.stopPropagation()">
          <div class="dropdown-header">{{ getUserName() }}</div>

          <!-- FIX: remove href -->
          <a class="dropdown-item" (click)="$event.preventDefault()">
            <i class="fa-regular fa-user"></i> My Profile
          </a>

          <a class="dropdown-item" (click)="signOut()">
            <i class="fa-solid fa-right-from-bracket"></i> Sign Out
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Navbar -->
  <nav class="navbar">
    <ul>
      <!-- <li><i class="fa-solid fa-gauge-simple-high" style="color: white;"></i></li> -->
      <li><a routerLink="/workitems" [class.active]="isWorkitemActive()">Work Items</a></li>
      <li>
        <a routerLink="/subcontractor" [class.active]="isSubcontractorActive()">Subcontractors</a>
      </li>
      <li>
        <a [routerLink]="'/projectdetails'" [class.active]="isProjectsActive()">Projects</a>
      </li>
    </ul>
  </nav>
</header>

<!-- Reminder Popup Modal -->
<div class="custom-modal-backdrop" *ngIf="showSetReminderPopup"></div>

<div class="custom-modal" *ngIf="showSetReminderPopup">
  <div class="modal-content-box">
    <!-- Modal Header -->
    <div class="modal-header">
      <p class="modal-title">Settings</p>
      <p class="modal-subtitle">
        Global Reminder Configuration for configuring default reminder settings for all RFQs
      </p>
    </div>

    <!-- Modal Body -->
    <div class="modal-body">
      <!-- Reminder Sequence -->
      <div class="modal-section">
        <div class="row">
          <label class="label">Max Reminder Sequence</label>

          <!-- Max Reminder Sequence -->
          <div class="custom-dropdown" (clickOutside)="open = false">
            <div
              class="dropdown-btn"
              (click)="toggleMaxSequenceDropdown(); $event.stopPropagation()"
            >
              {{ maxSequenceLimit || '0' }}
              <svg class="dropdown-icon" viewBox="0 0 24 24">
                <path d="M6 9l6 6 6-6" />
              </svg>
            </div>
            <ul class="dropdown-list" *ngIf="open">
              <li
                *ngFor="let limit of numberList"
                (click)="selectLimit(limit)"
                [class.selected]="limit === maxSequenceLimit"
              >
                {{ limit }}
              </li>
            </ul>
          </div>
        </div>

        <!-- Reminder Sequence Multi Select -->
        <div class="row">
          <label class="label">Reminder Sequence</label>

          <!-- Reminder Sequence Multi Select -->
          <div class="dropdown" (clickOutside)="dropdownOpen = false">
            <div class="dropdown-btn" (click)="toggleReminderDropdown(); $event.stopPropagation()">
              <span class="dropdown-text" [class.placeholder]="!selectedReminderSequence.length">
                {{
                  selectedReminderSequence.length
                    ? selectedReminderSequence.join(', ')
                    : '-- Select --'
                }}
              </span>

              <div class="arrow">
                <span
                  class="clear"
                  (click)="clearSelected($event)"
                  [class.active]="selectedReminderSequence.length"
                >
                  ×
                </span>
                <span>{{ dropdownOpen ? '▲' : '▼' }}</span>
              </div>
            </div>

            <div class="dropdown-content" *ngIf="dropdownOpen" (click)="$event.stopPropagation()">
              <div
                class="dropdown-item"
                *ngFor="let value of values"
                [class.disabled]="isDisabled(value)"
                (click)="onRowClick(value)"
              >
                <input
                  type="checkbox"
                  [checked]="isChecked(value)"
                  [disabled]="isDisabled(value)"
                  (click)="$event.stopPropagation()"
                  (change)="onCheck(value, $event.target.checked)"
                />
                <span>{{ value }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Set Time -->
      <div class="row">
        <label class="label">Set Time</label>
        <div class="time-wrapper">
          <input type="time" class="time-input" [(ngModel)]="reminderTimeValue" />
          <i class="fa fa-clock-o time-icon"></i>
        </div>
      </div>

      <!-- Email Body -->
      <div class="modal-section">
        <label class="label block">Email Body</label>
        <textarea class="email-body" rows="4" [(ngModel)]="reminderEmailBody"></textarea>
      </div>

      <!-- Enable Reminder -->
      <div class="checkbox-row">
        <input type="checkbox" id="enableGlobalReminders" [(ngModel)]="enableGlobalReminders" />
        <label for="enableGlobalReminders"> Enable automated reminders globally </label>
      </div>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button class="btn cancel-btn" (click)="closeReminderConfig()">Cancel</button>
      <button class="btn reset-btn" (click)="resetReminderConfig()">Reset</button>
      <button class="btn submit-btn" (click)="setReminderConfig()">Set Reminder</button>
    </div>
  </div>
</div>
